# Created by Yakup EroÄŸlu
# Instagram Yakuperog123
# if you want to follow me Yakuperog123
import socket
import os
import requests
import optparse
import terminaltables
import time
import sys
list=[["Host","Scan Type","Dest"]]
try:
	def userinput():
		parse=optparse.OptionParser()
		parse.add_option("-u","--url",dest="Url",help="enter url without http://")
		parse.add_option("-s","--subwordlist",dest="subwordlist",help="select subdomain wordlist file")
		parse.add_option("-a","--hiddenurlwordlist",dest="hiddenwordlist",help="select hidden url wordlist file")
		return parse.parse_args()
	
	def hidden_url(url,wordlist):
		file=open(wordlist,"r")
		for word in file:
			word=str(word)
			Url = "http://"+url+"/"+word
			r=requests.get(Url)
			if str(r.status_code) == "200":
				print("\n[+]Found : " + Url)
				list.append([Url,"hidden url","found"])
			else:
				pass
			print("\r[*]Tried : "+Url.strip("\n"),end="")
	def subdomain(url2,wordlist2):
		file2=open(wordlist2,"r")
		for subdomains in file2:
			subdomainss=subdomains.strip("\n")
			try:
				Url2="http://"+subdomainss+"."+url2
				r=requests.get(Url2,timeout=0.2)
				print("\n[+]Found: "+Url2)
				list.append([Url2,"subdomain","found"])
			except requests.exceptions.ConnectionError:
				pass
			print("\r[*]Tried:"+Url2.strip("\n"),end="")
	def portscanner(url):
		for i in range(0, 65000):
			print(f"\r[*]Scanning Port:{i}",end="")
			s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
			s.settimeout(float(0.3))
			conn = s.connect_ex((url, i))
			if(conn == 0) :
				print ('\n[+]Port %d: OPEN' % (i,))
				list.append([url,"Port Scanner",i])
			s.close()
	user,args=userinput()
	url=user.Url
	wordlist=user.subwordlist
	wordlist2=user.hiddenwordlist
	
	os.system("clear")
	os.system("figlet WebApplicationAnalyze")
	print("Scan Started...")
	time.sleep(1)
	print("----------------Subdomain Scaning Started-----------------")
	subdomain(url,wordlist2)
	print("\n----------------Hidden Url Scaning Started-----------------")
	hidden_url(url,wordlist)
	print("\n----------------Port Scaning Started-----------------")
	ip=socket.gethostbyname(url)
	portscanner(ip)
	print("\n\nRESULTS:  \n")
	table=terminaltables.AsciiTable(list)
	print(table.table)
except KeyboardInterrupt:
	input("press Enter if you want to exit ")
	sys.exit()
